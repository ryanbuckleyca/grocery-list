<!-- 
  TODO:
  [rb] Make section to edit headers/categories
  [jv] Allow user to create custom order. Drag and drop elements of list?
  Swipe left to delete, right to edit? Instead of buttons
  [rb] Overlay form for creating new FoodItem instead of prompt*2
  [jv] Allow for create page in server.js
  [rb] Create Shop page
  Enable team shopping
  [rb] enable dark mode
  Make collapsible categories
  [rb] figure out why outline persists following enter key after edit
 -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>311 Grocery List</title>

    <link href="https://fonts.googleapis.com/css2?family=Itim&family=Leckerli+One&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/reefjs/dist/reef.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reefjs/dist/router.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.15/lodash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slipjs/2.1.1/slip.min.js" integrity="sha256-MUibb4/CUL8gvOf3RxMc1jiYcI5r2oVXlmxQNLZr6pU=" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/a367e5e4f1.js" crossorigin="anonymous"></script>
    <!-- App styles -->
    <link type="text/css" rel="stylesheet" href="light.css" title="swap" />
    <link type="text/css" rel="stylesheet" href="style.css" />
    <link type="text/css" rel="stylesheet" href="lasers.css" />
    <script>
      const cookieStyle = document.cookie.replace("style=", "")
      const linkTags = document.getElementsByTagName("link")
      let linkElToSwap

      for(link of linkTags) { 
        if(link.title === "swap") { 
          linkElToSwap = link 
        } else if(link.title === "lasers")
          linkLaserToDel = link
      }

      if(!linkElToSwap) { 
        console.log("cannot find a <link> tag with title \"swap\"")
       } else {
        //set user's preferred style, if exists
        if(cookieStyle === "light.css" || cookieStyle === "dark.css" || cookieStyle === "rave.css")
          setLinkTag(cookieStyle)

        function switchStyle() {
          if(linkElToSwap.href.includes("light.css")) {
            switchTo = "dark.css"
          } else if(linkElToSwap.href.includes("rave.css")) {
            switchTo = "light.css"
            try {
              document.getElementsByTagName("iframe")[0].remove()
              document.getElementById("lasers").remove()
            }
            catch (error) {
              //do nothing
            }
          } else {
            switchTo = "rave.css"
            node = document.createElement("iframe")
            node.width="100%" 
            node.height="300"
            node.scrolling="no"
            node.frameborder="no"
            node.allow="autoplay"
            node.src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/430387740&color=%23e6e624&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"
            document.getElementsByTagName("hr")[0].after(node)

            node = document.createElement("span")
            node.id="lasers"
            document.getElementById("groceryList").before(node)

            node = document.createElement("div")
            node.className = "laser-beam-blue"
            document.getElementById("lasers").appendChild(node)
            node = document.createElement("div")
            node.className = "laser-beam-red"
            document.getElementById("lasers").appendChild(node)
            node = document.createElement("div")
            node.className = "laser-beam-purple"
            document.getElementById("lasers").appendChild(node)
            node = document.createElement("div")
            node.className = "laser-beam-green"
            document.getElementById("lasers").appendChild(node)
          }

          setLinkTag(switchTo)
        }

        function setLinkTag(value) {
          linkElToSwap.setAttribute("href", value)
          document.cookie = "style=" + value
        }
      }
    </script>


  </head>
  <body onload="attachSlip()">
    <div id="groceryList" class="container-fluid">
      <div id="groceryMenu" class="row no-gutters text-center align-top">
        <button id="menuButton" class="menuButton col-1" onclick="toggleMenu()">
          <i class="fas fa-hamburger"></i>
        </button>
      </a>
        <div class="col-10">
        <h1><span>Grocery List</span></h1>
          <div id="dropdown" style="display: none">
            <a href="/stock"><span>Stock</span></a>
            <a href="/shop"><span>Shop</span></a>
            <a href="/about"><span>About</span></a>
            <a href="#style" onclick="switchStyle()"><span><i class="fas fa-adjust"></i></span></a>
          </div>
        </div>
        <button class="scrollButton col-1" onclick="window.scroll(0,0)">
          <i class="fas fa-arrow-up"></i>
        </button>
      </div>
      <hr />

      <div class="row">
        <div id="app" class="col-12"></div>
      </div>

      <script src="index.js" type="application/javascript"></script>
  </body>
</html>